<!doctype html>

<meta name="google-site-verification" content="WdtuHFXzHspUNK1H7e-nXROTHR-BVHiZh3MH-4GBSiU">

<title>Test</title>

<style>

    .hide { display: none }

</style>

<div id="message"></div>
<a class="hide" id="sign-out">Sign out</a>

<script>

function onClientLoad() {
    var goog = {
        apiKey: "AIzaSyBP5AxfuHR3W-zlJRe_DGpRtgv0nL13cxs",
        clientId: "216008935087-f9vlpnbj9ilh4cevllsuc57d8brnhou9.apps.googleusercontent.com",
        authScopes: [ "https://www.googleapis.com/auth/plus.login" ]
        //sTJ_sX3eWFF8k46YE0IVeDEf
    };

    function checkAuth(immediate) {
        function handleAuthorizeRequest(result) {
            var message = $I("message");

            if (result && !result.error) {
                var signOutButton = document.getElementById("sign-out");
                signOutButton.classList.remove("hide");
                signOutButton.addEventListener("click", function () {
                    gapi.auth.signOut();
                });
            } else {
                document.getElementById("message").innerHTML = "Please sign in to see upcoming rides:<br>" +
                    "<a class=gplus-sign-in id=gplus-sign-in>Sign in with Google</a>";

                var signInButton = document.getElementById("gplus-sign-in");
                signInButton.addEventListener("click", function () {
                    checkAuth(false);
                });
            }
        }

        gapi.auth.authorize({
            "client_id": goog.clientId,
            scope: goog.authScopes,
            immediate: immediate
        }, handleAuthorizeRequest);
    }

    gapi.client.setApiKey(goog.apiKey);
    gapi.client.load("calendar", "v3");

    checkAuth(true);
}

</script>

<script src="https://apis.google.com/js/client.js?onload=onClientLoad"></script>
